# Maintainer: Massimiliano Torromeo <massimiliano.torromeo@gmail.com>

pkgname=kag
pkgver=40
pkgrel=1
pkgdesc="King Arthur's Gold: A 2D multiplayer-only RTS/building game."
url="http://kagdev.tumblr.com/"
license=('custom')
arch=('i686' 'x86_64')
makedepends=('unzip')
source=("${pkgname}${pkgver}_x.zip")

depends=('libgl' 'libxxf86vm')
[ $CARCH == "x86_64" ] && depends=('lib32-libgl' 'lib32-libxxf86vm')

options=('!strip')

package(){
	mkdir -p "$pkgdir/opt/kag"
	mkdir -p "$pkgdir/usr/bin"

	cp -R "$srcdir/kag_x/"{App,Base,Cache,lib,Logs} "$pkgdir/opt/kag"
	install -m0755 "$srcdir/kag_x/KAG" "$pkgdir/opt/kag/KAG"
	chmod 777 "$pkgdir/opt/kag/"{Logs,Cache}

	echo "#!/bin/sh
cd /opt/kag
./KAG autostart Scripts/autostart.gm autoconfig Scripts/autoconfig.gm" > "$pkgdir/usr/bin/kag"
	chmod 755 "$pkgdir/usr/bin/kag"

	echo "#!/bin/sh
cd /opt/kag
./KAG autostart Scripts/dedicated_autostart.gm autoconfig Scripts/dedicated_autoconfig.gm" > "$pkgdir/usr/bin/kag-server"
	chmod 755 "$pkgdir/usr/bin/kag-server"

	install -D -m0644 "$srcdir/kag_x/readme.txt" "$pkgdir/usr/share/licenses/$pkgname/README"
}

md5sums=('d355ee501b9fa349c40c307ac323abf9')
